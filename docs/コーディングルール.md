# 📘 コーディングルール

## 🔠 1. 命名規則

| 対象 | Java（Spring Boot） | React / Typescript（Next.js） |
|----------|----------|----------|
| ファイル名 | パスカルケース（例：`UserController.java`） | キャメルケース（例：`userCard.tsx`） |
| クラス名 | パスカルケース（例：`UserService`） | パスカルケース（例：`UserCard.tsx`） |
| メソッド名/関数名 | キャメルケース（例：`getUserName`） | キャメルケース（例：`handleClick`） |
| 変数名 | キャメルケース（例：`userName`） | キャメルケース（例：`userList`） |
| 定数名 | 全て大文字 + アンダースコア（例：`MAX_LENGTH`） | 全て大文字 + アンダースコア（例：`API_BASE_URL`） |

---

## ⬛ 2. インデント・スペース

| 項目 | Java（Spring Boot） | React / Typescript（Next.js） |
|----------|----------|----------|
| インデント | 4スペース | 2スペース（Prettier推奨） |
| 空白の使い方 | `if (condition) {`←括弧の間にスペース | JSXでも同様 |

---

## 📐 3. コーディングスタイル

- 中括弧は改行せず、同じ行に`{`を書く。
- 一行の長さは、100文字以内を目安に書く。
- 一つの関数は「一つの目的」に絞って書く。
- 関連する処理は近くにまとめて書く。
- コードは「上から下へ」読んで意味が通じるように書く。
- ネストは浅く、ガード節を使って早期リターンする。
  ```python
  # NG
  if user is not None:
      if user.is_active:
          do_something()

  # OK
  if user is None:
      return
  if not user.is_active:
      return
  do_something()
  ```
- ループの変数名は目的を明確にする。
  - `for i in range()` → `for user in userList`
- JSXは、属性が3つ以上ある場合は改行で整える。
- 変数は再利用せずに、1つの変数には1つの意味だけを持たせる。（変数の意味を変えない）
  ```js
  // NG
  let result = getUser();
  result = formatUser(result);

  // OK
  let user = getUser();
  let formattedUser = formatUser(user);
  ```

---

## 💬 4. コメントのルール

- コメントは「どう動くか」ではなく「なぜそうするのか」という**理由・考え**を書く。
  ```js
  // NG: 変数aを3倍する
  a = a * 3;

  // OK: 単価が3ヶ月分になるため
  monthlyFee = monthlyFee * 3;
  ```
- 必要に応じて、TODOやFIXMEコメントも活用する。
  - 例：`// TODO: バリデーション追加`）
### Java（Javadocスタイル）
```java
/**
 * ユーザーの名前を取得する
 * @param userId ユーザーのID
 * @return ユーザー名
 */
public String getUserName(Long userId) {
    ...
}
```
### Typescript（関数の目的 + 補足説明）
```ts
/**
* ボタンクリック時の処理
* ユーザーの状態をトグルします
*/
const handleToggle = () => {
  ...
}
```

---

## ✅ 5. わかりやすい名前をつける

- 変数名・関数名は「具体的」にする。
  - 例）`data`, `temp` → `userList`, `fetchUserData`
- 関数名は動詞から始めて、動作がわかるようにする。
  - 例）`getUser()`, `calculateTotal()`
- ブール型は `is`, `has`, `can` などの接頭辞を使う。
  - 例）`isLoggedIn`, `hasPermission`, `canDelete`
- 省略語は基本的に使わない。
  - 例）`usr`, `cnt` → `user`, `count`
- 関数の中身を読まなくても関数の意図が明確にわかるようにする。
  ```js
  // NG: 変数aを3倍する
  a = a * 3;

  // OK: 単価が3ヶ月分になるため
  monthlyFee = monthlyFee * 3;
  ```

---

## ⚠️ 6. エラーハンドリング・例外処理
### Java（Spring Boot）
- `try-catch`は必要最小限にする。
- カスタム例外クラスを作成する。
  - 例）`UserNotFoundException`
  ```java
  try {
      User user = userService.getUserById(id);
  } catch (UserNotFoundException e) {
      throw new ResponseStatusException(HttpStatus.NOT_FOUND, "User not found");
  }
  ```
### React / Typescript
- 外部APIを呼び出す時は`try-catch`を使う。
  ```ts
  try {
    const res = await fetch("/api/user");
    if (!res.ok) throw new Error("API Error");
  } catch (e) {
    console.error(e);
    alert("ユーザー情報の取得に失敗しました");
  }
  ```

---

## 🔒 7. セキュリティ・安全なコーディング指針

- バリデーションは、フロントエンドとバックエンドの両方で実装する。
- Spring Securityを有効にして、CSRF（Cross-Site Request Forgeries）やXSS（クロスサイトスクリプティング）への対策を行う。
- APIのレスポンス内容には、パスワードなどの重要情報は含めない。
- `dangerouslySetInnerHTML`によるReactのレンダリングは行わない。
- JWTやセッションを使って、認証情報は安全に保管する。

---

## 🧪 8. テストの実施ルール

- 単体テストはテストコードを実装して実施する。
- 結合テスト・総合テストは、画面操作やツールを利用して実施する。

### Java（Spring Boot）
- テストフレームワークは「JUnit 5」を使う。
- 単体テストは`@SpringBootTest`を使わずに、`MockMvc`などを使って軽量にする。
- テストクラスは以下のような命名にする。
  - 例）`UserServiceTest.java`
- テストカバレッジは「60％以上」を目標にする。

### React / Typescript
- テストフレームワークは「Jest」 + 「React Testing Library」を使う。
- テストファイルは以下のような命名にする。
  - 例）`UserCard.test.tsx`
- UIのテストは、画面の変化やクリック時の挙動などの「動作」の確認を重視する。

---

## ✅ 9. その他・運用ルール

- `feature`ブランチは基本的に`develop`ブランチから作成する。
  - 詳細は[こちら](https://app.diagrams.net/#G1QSuHXCppJ-SIw-7FFiWbs0RuHMQks6tw#%7B%22pageId%22%3A%22-LsIpP2-QfD-JlulJf7W%22%7D)を参照。
- プルリクエストには「実装内容の概要」を説明欄に書く。
- コードレビューでは「理由＋改善案」をセットで伝える。

---

## 参考書籍
- [リーダブルコード ― より良いコードを書くためのシンプルで実践的なテクニック](https://www.oreilly.co.jp/books/9784873115658/)
